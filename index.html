<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ArtBox MB ‚Äì unikatni pokloni od drveta</title>

  <link rel="icon" type="image/png" href="grb.jpg" />
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/lightbox2@2/dist/css/lightbox.min.css" rel="stylesheet" />

  <style>
    body { font-family: "Poppins", sans-serif; background-color: #f7f1e6; color: #4b3f2f; margin: 0; padding: 0; }
    header { text-align: center; background: url("https://www.transparenttextures.com/patterns/wood-pattern.png"); padding: 40px 20px; }
    .header-content h1 { font-size: 2.5em; margin: 0; font-family: "Brush Script MT", cursive; color: #3a2b1a; }
    .subtitle { font-size: 1.2em; margin-bottom: 5px; }
    .highlight { background-color: #d4b483; display: inline-block; padding: 6px 12px; border-radius: 5px; font-weight: bold; }
    .fb-button { display: inline-block; margin-top: 10px; background-color: #4b3f2f; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; }
    .fb-button:hover { background-color: #6a563f; }

    #toTopBtn { position: fixed; bottom: 20px; right: 20px; background-color: #4b3f2f; color: white; border: none; padding: 12px 18px; border-radius: 8px; cursor: pointer; display: none; font-weight: bold; z-index: 99; }
    #toTopBtn:hover { background-color: #6a563f; }

    #main-content { display: flex; flex-wrap: wrap; align-items: flex-start; padding: 20px; gap: 20px; }
    #gallery { flex: 3; min-width: 300px; }
    .gallery-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 15px; justify-items: center; }
    .gallery-container img { width: 100%; max-width: 300px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.15); transition: transform 0.25s ease, box-shadow 0.25s ease; cursor: pointer; }
    .gallery-container img:hover { transform: scale(1.05); box-shadow: 0 6px 15px rgba(0,0,0,0.25); }

    #contact-sidebar { flex: 1; min-width: 280px; position: sticky; top: 20px; background-color: #fffaf3; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); height: fit-content; }
    footer { text-align: center; padding: 20px; background-color: #e8dcc5; color: #3a2b1a; margin-top: 40px; font-size: 0.95em; }

    #uploadModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
    #uploadModal .modal-content {
      background-color: #fff8eb;
      padding: 25px;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      text-align: center;
      position: relative;
    }
    #uploadModal input, #uploadModal textarea { width: 90%; padding: 10px; margin: 5px 0; border-radius: 6px; border: 1px solid #ccc; }
    #uploadModal button { background-color: #4b3f2f; color: #fff; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
    #uploadModal button:hover { background-color: #6a563f; }
    #closeUploadModal { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 22px; cursor: pointer; }

    @media (max-width: 900px) { #main-content { flex-direction: column; } #contact-sidebar { position: static; width: 90%; margin: 0 auto; } }
  </style>
</head>

<body>
  <header>
    <div class="header-content">
      <h1>ArtBox MB</h1>
      <p class="subtitle">Unikatni pokloni od drveta</p>
      <p class="highlight">üì¶ ≈†aljemo brzom po≈°tom u sve gradove BiH</p>
      <a href="https://www.facebook.com/profile.php?id=100064599767535" target="_blank" class="fb-button">Pogledaj na Facebooku</a>
    </div>
  </header>

  <div style="text-align:center; margin-top:20px;">
    <button id="openUploadModal" style="background-color:#4b3f2f;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-weight:bold;">
      üì∏ Dodaj novu fotografiju
    </button>
  </div>

  <div id="uploadModal">
    <div class="modal-content">
      <button id="closeUploadModal">‚úñ</button>
      <h2>Dodaj novu fotografiju</h2>
      <input type="password" id="uploadPass" placeholder="Unesi pristupnu lozinku" /><br>
      <input type="file" id="uploadFile" accept="image/*" /><br>
      <textarea id="uploadDesc" placeholder="Opis slike..."></textarea><br>
      <button id="uploadBtn">üì§ Po≈°alji</button>
      <p id="uploadStatus"></p>
    </div>
  </div>

  <section id="main-content">
    <section id="gallery">
      <h2>Galerija</h2>
      <div id="gallery-container" class="gallery-container"></div>
    </section>

    <!-- üîπ KONTAKT OBRAZAC -->
    <aside id="contact-sidebar">
      <h2>Kontakt</h2>
      <form id="contactForm">
        <label>Ime i prezime:</label>
        <input type="text" name="Ime" required />

        <label>Broj telefona:</label>
        <input type="tel" name="Telefon" />

        <label>Email adresa:</label>
        <input type="email" name="Email" required />

        <label>Poruka:</label>
        <textarea name="Poruka" rows="4" required></textarea>

        <button type="submit">Po≈°alji poruku</button>
      </form>
      <p id="formStatus" style="margin-top:10px; font-weight:bold;"></p>
    </aside>
  </section>

  <footer>
    <p>üìç Kralja Tvrtka, Vitez, Bosna i Hercegovina</p>
    <p>üìû 063 124 574 | ‚úâÔ∏è <a href="mailto:artboxmb@gmail.com">artboxmb@gmail.com</a></p>
    <p>üåê <a href="https://www.facebook.com/profile.php?id=100064599767535" target="_blank">Facebook ArtBox</a></p>
    <p>¬© 2025 ArtBox MB ‚Äì ruƒçni rad s du≈°om</p>
  </footer>

  <button id="toTopBtn" onclick="scrollToTop()">‚¨Ü Na vrh</button>

  <script src="https://cdn.jsdelivr.net/npm/lightbox2@2/dist/js/lightbox-plus-jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
  // --- Gumb na vrh
  const toTopBtn = document.getElementById("toTopBtn");
  window.onscroll = () => toTopBtn.style.display = window.scrollY > 300 ? "block" : "none";
  function scrollToTop() { window.scrollTo({ top: 0, behavior: "smooth" }); }

  // --- Modal upload
  const openModal = document.getElementById("openUploadModal");
  const closeModal = document.getElementById("closeUploadModal");
  const modal = document.getElementById("uploadModal");
  openModal.addEventListener("click", () => modal.style.display = "flex");
  closeModal.addEventListener("click", () => modal.style.display = "none");
  window.addEventListener("click", (e) => { if (e.target === modal) modal.style.display = "none"; });

  // --- Upload slike
  document.getElementById("uploadBtn").addEventListener("click", async () => {
    const pass = document.getElementById("uploadPass").value.trim();
    const file = document.getElementById("uploadFile").files[0];
    const desc = document.getElementById("uploadDesc").value.trim();
    const status = document.getElementById("uploadStatus");

    if (pass !== "ivo11111986") return status.textContent = "‚ùå Pogre≈°na lozinka!";
    if (!file) return status.textContent = "‚ö†Ô∏è Odaberi sliku.";

    status.textContent = "‚è≥ Uƒçitavam...";
    const base64 = await toBase64(file);
    const payload = { image_name: file.name, image_desc: desc || "", image_base64: base64.split(",")[1] };

    try {
      const res = await fetch("https://nameless-resonance-66de.artboxmb.workers.dev", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
      if (res.ok) {
        status.textContent = "‚úÖ Slika poslana! Bit ƒáe vidljiva uskoro.";
        await loadUploadedImages(true);
      } else status.textContent = "‚ö†Ô∏è Gre≈°ka pri slanju slike.";
    } catch {
      status.textContent = "‚ùå Gre≈°ka pri spajanju na server.";
    }
  });

  function toBase64(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.readAsDataURL(file);
      reader.onload = () => resolve(reader.result);
      reader.onerror = reject;
    });
  }

  // --- Uƒçitavanje galerije
  async function loadUploadedImages(refresh = false) {
    try {
      const gallery = document.getElementById("gallery-container");
      if (refresh) gallery.innerHTML = "";

      const res = await fetch("https://api.github.com/repos/artboxmb/artboxmb/contents/uploads");
      const files = await res.json();
      const images = files.filter(f => f.name.match(/\.(jpg|jpeg|png|gif|jfif)$/i)).reverse();

      for (const img of images) {
        const imgUrl = `https://raw.githubusercontent.com/artboxmb/artboxmb/main/uploads/${img.name}`;
        const descUrl = `https://raw.githubusercontent.com/artboxmb/artboxmb/main/uploads/${img.name}.txt`;

        let opis = img.name;
        try {
          const descRes = await fetch(descUrl);
          if (descRes.ok) opis = await descRes.text();
        } catch {}

        const a = document.createElement("a");
        a.href = imgUrl;
        a.setAttribute("data-lightbox", "artbox");
        a.setAttribute("data-title", opis.trim());

        const imageEl = document.createElement("img");
        imageEl.src = imgUrl;
        imageEl.alt = opis.trim();

        a.appendChild(imageEl);
        gallery.appendChild(a);
      }
    } catch (err) {
      console.error("‚ùå Gre≈°ka pri uƒçitavanju slika:", err);
    }
  }

  window.addEventListener("DOMContentLoaded", loadUploadedImages);

  // --- Lightbox postavke
  lightbox.option({ resizeDuration: 200, wrapAround: true, showImageNumberLabel: false });

  // --- EmailJS integracija
  (function(){ emailjs.init("esz6-yE_k9uHLQtoY"); })();

  document.getElementById("contactForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const status = document.getElementById("formStatus");
    status.textContent = "‚è≥ ≈†aljem poruku...";

    const data = {
      ime: this.Ime.value,
      telefon: this.Telefon.value,
      email: this.Email.value,
      poruka: this.Poruka.value
    };

    emailjs.send("service_z1edus4", "template_oir8m86", data)
      .then(() => {
        status.textContent = "‚úÖ Poruka uspje≈°no poslana! Hvala na javljanju.";
        this.reset();
        // Auto reply
        emailjs.send("service_z1edus4", "template_oir8m86", {
          ime: data.ime,
          email: data.email,
          poruka: "Hvala na poruci! Va≈°a poruka je primljena, javit ƒáemo se uskoro. üåø"
        });
      })
      .catch(err => {
        status.textContent = "‚ùå Gre≈°ka pri slanju: " + err.text;
        console.error(err);
      });
  });
</script>
</body>
</html>
